# Computational Biology Capstone Project

## Sophia Judish

### Paper: 
"Brain tumor segmentation with self-ensembled, deeply-supervised 3D U-net neural networks: a BraTS 2020 challenge solution"

### Authors:
Theophraste Henry, Alexandre Carre, Marvin Lerousseau, Theo Estienne, Charlotte Robert, Nikos Paragios, Eric Deutsch

### Paper link: 
https://arxiv.org/pdf/2011.01045

![Screenshot%202025-06-05%20at%2011.53.38%E2%80%AFAM.png](Screenshot%202025-06-05%20at%2011.53.38%E2%80%AFAM.png)

## Literature Review

### What does this paper accomplish?
- This paper trained U-net like neural networks to produce brain tumor segmentation maps from MRIs of brains with gliomas.
- The models were trained on the 2020 BraTS dataset, which provides specific sets of brain MRIs for training, testing, and validation. 
- BraTS is a yearly competition where researchers build algorithms to detect and outline brain tumors from medical images.

![Screenshot%202025-06-05%20at%2012.08.05%E2%80%AFPM.png](Screenshot%202025-06-05%20at%2012.08.05%E2%80%AFPM.png)

### Methods, Evaluation and Innovation
- The U-net like network used three rounds of downsampling and upsampling to capture features then reconstruct detailed tumor maps.
- Two different training pipelines were used to create models (different learning rates, epochs, etc.)
- The labelmap (scan where the tumor is labeled) from each pipeline was merged to created the final result.
- Pipeline B was found to be better at segmenting edema, so edema predictions from B were preferred, while predictions for other subregions like enhancing tumor (ET) and tumor core (TC) from Pipeline A were kept intact.
- The parameters used made this model a top 10 solution in the 2020 BraTS challenge.

![Screenshot%202025-06-05%20at%2012.09.35%E2%80%AFPM.png](Screenshot%202025-06-05%20at%2012.09.35%E2%80%AFPM.png)

### Why is this topic important?
- Gliomas, especially glioblastomas, are common and aggressive brain tumors in adults, with patients typically facing a poor prognosis.
- Tumor segmentation is important for gliomas as they are often heterogeneous tumors that must be classified into different regions. 
- Accurate tumor segmentation is critical for patient treatment management and prognostic estimation.
- This research can support treatment for gliomas and improve patient outcomes.


### Why am I interested in this project? 
- I am majoring in Biochemistry and Computer Science and I am currently in the process of applying to medical school. 
- I chose research on brain tumors specifically because I hope to eventually be a neurologist.
- I hope to use my computer science background to engage in research initiatives similar to this project to develop new treatments, medical tools, and improve patient outcomes in the field of neurology.

## Expansion
- The paper includes multiple pipelines, but I focused on ‘Pipeline A’ as it has open-sourced code.

### My Goals
I aimed to evaluate per-case performance of the U-net to identify specific patient cases where the model performs poorly. I chose to use the Hausdorff Distance as my evaluation metric. This measures how far boundaries of segmentations are from each other. I wanted to analyze the poor performing cases in comparison with the best performing cases to gain insight into MRI characteristics that may be causing certain scans to be less successful in segmentation than others. I wanted to identify weak points in the model, as this could be useful in future model development

### Input 
I began my project using two key resources, the BraTS 2020 tumor dataset and the open-source segmentation model code provided by the paper I am focusing on. 
### Data
The first was MRI data from Brats2020 dataset (training and validation). I downloaded this data by making an account with Synapse, which is the official platform for requesting downloads of old BraTS data. To get this dataset, I needed to provide information on my intents for the data and my affiliated University, then wait to receive a response to my request. 
![Screenshot%202025-06-05%20at%2010.30.44%E2%80%AFPM.png](Screenshot%202025-06-05%20at%2010.30.44%E2%80%AFPM.png)
Both the training and validation datasets had several MRI sequence types, including t2, t1ce, t1, and flair. Based on my research, each of these different sequences visualize brain tissues and tumors in different ways. I found that certain scans provided better segmentation of different tumor regions. For instance, .flair was described to be best for analyzing Whole Tumor (WT). 
The training dataset also included a ground truth segmentation file. 

### Code
I used open source code to train and validate a segmentation model. The code is located on GitHub at https://github.com/lescientifik/open_brats2020. Before I could start training the model, I needed to upload my data and code onto the remote Hamachi server, as I needed more GPUs than were available on my Mac. Additionally, I needed to download the dependencies and change the directories of the training and validation data in the code. 

### Training Model
- Before I could start training the model, I needed to upload my data and code onto the remote Hamachi server, as I needed more GPUs than were available on my Mac. I logged into the Hamachi server with the following command: 
code --folder-uri "vscode-remote://ssh-remote+hamachi/homes/iws/sjudish/open_brats2020"
- Additionally, I needed to download the dependencies and change the directories of the training and validation data in the code. I had to troubleshoot this slightly as I had multiple versions of Python downloaded.
- I ran the model once with 10 epochs and once with 20 epochs in the interest of time, to keep the project moving forward. In the future, I would definitely train for more epochs to ensure convergence and achieve the best results.
- I began training using the command:
python -m src.train --devices 0 --width 48 --arch EquiUnet --epochs 20
- Once training was complete for the first time, there was an output folder called "runs". This folder would create a new directory for each time trained the model with a new segmentation file for each patient and a .csv file called patients_indiv_perf.csv which contained a file with performance metrics for each patient, per patient & tumor subregion (WT, TC, ET). 

![Screenshot%202025-06-08%20at%2010.46.51%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2010.46.51%E2%80%AFAM.png)

![Screenshot%202025-06-08%20at%2010.48.36%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2010.48.36%E2%80%AFAM.png)

#### Performance Metrics
The four performance metrics available were:
1. Dice coefficient (dice)
    What it is: Measures overlap between predicted and ground truth segmentation.

    Range: 0 (no overlap) to 1 (perfect match).

    Good value: High is good — closer to 1.0 is better.

    Target: ≥ 0.8 is generally considered good for medical segmentation.


2. Hausdorff distance (haussdorf)
    What it is: Measures the maximum distance between the predicted and true boundaries.

    Units: In voxels or mm, depending on dataset preprocessing.

    Good value: Low is good — a smaller distance means the boundaries are closely aligned.

    Target: < 10 is considered reasonable for many BraTS tasks, but varies.


3. Sensitivity (sens)
    What it is: True positive rate — how well the model finds the tumor.

    Formula: TP / (TP + FN)

    Good value: High is good — closer to 1.0 means fewer missed tumors.


 4. Specificity (spec)
    What it is: True negative rate — how well the model avoids false alarms.

    Formula: TN / (TN + FP)

    Good value: High is good — closer to 1.0 means fewer false positives.
    

### Inference on Validation Set
- Next, I performed inference using a specific training run. To do this, I copied the path to the desired run's configuration file from the runs/ directory and used it in the following command:
python -m src.inference --config runs/20250531_223528__fold0_EquiUnet_48_batch1_optimranger_ranger_lr0.0001-wd0.0_epochs10_deepsupFalse_fp16_warm0__normgroup_dropout0.0_warm_restartFalse/20250531_223528__fold0_EquiUnet_48_batch1_optimranger_ranger_lr0.0001-wd0.0_epochs10_deepsupFalse_fp16_warm0__normgroup_dropout0.0_warm_restartFalse.yaml --devices 0 --on val
- This command ran inference on the validation set using the specified training configuration. The output was saved in the /preds/ directory, with one segmentation result file generated per patient in the validation set.

![Screenshot%202025-06-08%20at%2010.45.12%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2010.45.12%E2%80%AFAM.png)

- I explored the segmentation results using 3D Slicer, which allows overlaying multiple .nii files and visualizing segmentation regions in color. This helped me verify that the outputs were reasonable. 

![Screenshot%202025-06-08%20at%2010.43.14%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2010.43.14%E2%80%AFAM.png)

### Data Analysis

- In my data analysis, I chose to consider only WT (whole tumor cases) because radiomic features extracted from the entire tumor volume tend to be more comprehensive. 
- I chose to study the Hausdorff distance first, but the remaining process could be completed with any of these four metrics.
- I sorted the patient cases in a table and extracted those with the 20 best and 20 worst Hausdorff scores. 
- My raw data before sorting or filtering was as follows:

Results

    patient_id	label	tta	haussdorf	dice	sens	spec
    BraTS20_Training_325	WT	FALSE	94.94208761134340	0.27610567750141800	0.9403465636342350	0.9906621293114810
    BraTS20_Training_275	WT	FALSE	76.68115805072330	0.29669589617678000	0.6094236311239190	0.9902507505650320
    BraTS20_Training_268	WT	FALSE	98.5393322486001	0.32611712461837400	0.9330333509793540	0.9919660886440960
    BraTS20_Training_061	WT	FALSE	48.692915295759400	0.3602400547493290	0.9833780417704540	0.9918527012759670
    BraTS20_Training_079	WT	FALSE	114.31972708155000	0.4039252088582420	0.836238846945779	0.9981182001666910
    BraTS20_Training_340	WT	FALSE	59.87486951969080	0.4853750838512070	0.9865963467970160	0.98174087540931
    BraTS20_Training_005	WT	FALSE	88.87631855561980	0.5646674501523810	0.6453581022628970	0.9984206218770480
    BraTS20_Training_297	WT	FALSE	65.1536645170477	0.6458794361117940	0.8420778457510750	0.9935269250414600
    BraTS20_Training_303	WT	FALSE	52.20153254455280	0.6465354178729980	0.9343393489721350	0.9961458135710500
    BraTS20_Training_048	WT	FALSE	70.51950084905590	0.6549355495251020	0.7924005608946960	0.9979385894283490
    BraTS20_Training_086	WT	FALSE	101.7742600071350	0.6636552872606160	0.7681669236700080	0.9987260936262240
    BraTS20_Training_010	WT	FALSE	76.42643521714200	0.6952231940561380	0.9119599838499840	0.9964290771862810
    BraTS20_Training_295	WT	FALSE	78.03204469959760	0.6988795130723480	0.9987348278179730	0.9975584954104410
    BraTS20_Training_265	WT	FALSE	39.71145930332960	0.7255762510442530	0.9987043695138150 0.9947479510512560
    BraTS20_Training_036	WT	FALSE	80.77747210701760	0.7406917935293670	0.9826028320971000	0.9988842353506100
    BraTS20_Training_129	WT	FALSE	74.39085965358920	0.7470221213840050	0.9988202578579250	0.9954818453510200
    BraTS20_Training_315	WT	FALSE	92.00543462209180	0.7525539409951560	0.9986852100742130	0.9974776737074720
    BraTS20_Training_107	WT	FALSE	56.73623181001710	0.7635349961936320	0.9938795138585290	0.9976486697477280
    BraTS20_Training_080	WT	FALSE	67.47592163134940	0.7645504082260720	0.9716777102889750	0.9972107716148600
    BraTS20_Training_158	WT	FALSE	74.20916385460760	0.7681286968624000	0.979537505872527	0.9975393956546950
    BraTS20_Training_169	WT	FALSE	29.30870177950570	0.7752760064050340	0.9894946307882610	0.996459510298382
    BraTS20_Training_209	WT	FALSE	55.47972602672080	0.7812162427575370	0.989028237524671	0.9960580586807720
    BraTS20_Training_278	WT	FALSE	37.107950630558900	0.7968925890715560	0.9286601646517840	0.995083295767775
    BraTS20_Training_122	WT	FALSE	78.45380806563820	0.7999610582422660	0.9908953873982510	0.9990946443409940
    BraTS20_Training_361	WT	FALSE	102.57192598367300	0.8009288800092050	0.9747800735846420	0.9959227979227190
    BraTS20_Training_345	WT	FALSE	49.02040391510460	0.8056686803960550	0.8715601119138100	0.9968330696772220
    BraTS20_Training_134	WT	FALSE	85.65628990331070	0.8067072194653430	0.7495352123150150	0.9990085130883730
    BraTS20_Training_090	WT	FALSE	50.78385570237850	0.8072262612910330	0.971458872703453	0.9984307449880790
    BraTS20_Training_298	WT	FALSE	87.80091115700340	0.8083963876006830	0.9785948785292190	0.9977239029036370
    BraTS20_Training_052	WT	FALSE	69.49100661236680	0.81692060730524	0.9912080259406760	0.9977470288668750
    BraTS20_Training_130	WT	FALSE	13.564659966250500	0.8179529736183550	0.9902975188858260	0.9945368089656000
    BraTS20_Training_185	WT	FALSE	34.322004603461000	0.8185430082244890	0.9621428329704790	0.9961015237430890
    BraTS20_Training_076	WT	FALSE	62.65780079128220	0.8215818763950750	0.96370012321107	0.9981844057639860
    BraTS20_Training_184	WT	FALSE	75.67033764957050	0.8324694978104130	0.9688193998161540	0.9949912953569600
    BraTS20_Training_250	WT	FALSE	68.13222438758330	0.8390161351501180	0.9742244989226330	0.9970991197519730
    BraTS20_Training_359	WT	FALSE	85.53946457629950	0.8392599118942730	0.9823678472508690	0.9965588073487350
    BraTS20_Training_144	WT	FALSE	63.54525946126900	0.8553872163339620	0.9931200048315990	0.9925133813585220
    BraTS20_Training_239	WT	FALSE	44.83302354291980	0.8608343957981300	0.9396950123193710	0.997934578610548
    BraTS20_Training_171	WT	FALSE	37.3496987939662	0.8610578502904800	0.9211844853714150	0.9963554087419630
    BraTS20_Training_266	WT	FALSE	82.42572413997950	0.872687209849963	0.9738897022938020	0.9984509944307010
    BraTS20_Training_348	WT	FALSE	65.80273550544840	0.8747603272469810	0.9943368737663310	0.99731411276497
    BraTS20_Training_186	WT	FALSE	47.38143096192850	0.8774479741608410	0.9917437481227040	0.9960334883695560
    BraTS20_Training_197	WT	FALSE	61.45730225123780	0.8852185597709570	0.9962534862336520	0.9961911738776190
    BraTS20_Training_338	WT	FALSE	58.68560300448480	0.8864392142709840	0.9934060378448650	0.9960943348571140
    BraTS20_Training_339	WT	FALSE	59.74110812497540	0.8869490155864130	0.9272304132769720	0.9972539515161630
    BraTS20_Training_294	WT	FALSE	54.092513345194100	0.8872620470910650	0.9812712826333710	0.9978406333117250
    BraTS20_Training_207	WT	FALSE	90.77995373429090	0.8881699936469720	0.8972908151200890	0.9991772274787310
    BraTS20_Training_097	WT	FALSE	49.4064773081425	0.8886618649194700	0.9789013089235640	0.9979849621442990
    BraTS20_Training_351	WT	FALSE	64.6297145282261	0.8901082166178270	0.9741908763990460	0.9975922538940970
    BraTS20_Training_050	WT	FALSE	62.14499175315740	0.8912975843907640	0.9690142546508820	0.998077944923925
    BraTS20_Training_261	WT	FALSE	15.684387141358100	0.8976510865784220	0.9874570522864500	0.9939180156808970
    BraTS20_Training_309	WT	FALSE	45.44227107000710	0.8980958441431300	0.8749260848831670	0.9986824350324520
    BraTS20_Training_151	WT	FALSE	56.302753041037000	0.9003496449735080	0.9794267592629760	0.9966588954374390
    BraTS20_Training_271	WT	FALSE	61.35144660071190	0.902009268071405	0.9908740937603820	0.9988115122667140
    BraTS20_Training_306	WT	FALSE	9.273618495495700	0.9054797650038500	0.8882218189061770	0.9984781547992770
    BraTS20_Training_179	WT	FALSE	13.74772708486750	0.9064027253223300	0.9897607856052210	0.9985362024412500
    BraTS20_Training_113	WT	FALSE	48.02082881417190	0.9093844557480060	0.9971753660089120	0.9972028965091020
    BraTS20_Training_160	WT	FALSE	35.22782990761710	0.9123663440178360	0.8949237943229120	0.9990292252847330
    BraTS20_Training_270	WT	FALSE	57.48912940721920	0.9145846429891430	0.9756031810217010	0.9973325724803580
    BraTS20_Training_124	WT	FALSE	12.328828005938000	0.9161946681074810	0.9911383815286010	0.9965446984720150
    BraTS20_Training_100	WT	FALSE	31.559467676119	0.9168871252204590	0.9840002365953920	0.9975020323566650
    BraTS20_Training_093	WT	FALSE	34.84250278036870	0.9175949057985990	0.9899685885094740	0.9981246552675120
    BraTS20_Training_337	WT	FALSE	78.06407624509500	0.917832610455102	0.9875141782846730	0.9979130069045790
    BraTS20_Training_175	WT	FALSE	40.80441152620630	0.918580504395816	0.9584281880560720	0.9972592211854720
    BraTS20_Training_098	WT	FALSE	13.92838827718410	0.9193526225815210	0.9988335439434550	0.997145824885183
    BraTS20_Training_336	WT	FALSE	79.71198153351850	0.9230421065243150	0.9903919402757680	0.9981486988982410
    BraTS20_Training_040	WT	FALSE	29.223278392404900	0.924934094170254	0.9699686213211710	0.9975052948959560
    BraTS20_Training_001	WT	FALSE	21.283796653792800	0.9274178914897480	0.9403242774048370	0.9978717352792060
    BraTS20_Training_355	WT	FALSE	14.7648230602334	0.9291570175290320	0.9956239494580650	0.9976847490823640
    BraTS20_Training_244	WT	FALSE	28.861739379323600	0.9343820369298080	0.970769498141761	0.9981744956595720
    BraTS20_Training_133	WT	FALSE	28.722813232690100	0.935253079525405	0.9576047864494420	0.9987642106128470
    BraTS20_Training_216	WT	FALSE	27.80287754891570	0.937713656642911	0.9384982437537280	0.9995700098019270
    BraTS20_Training_198	WT	FALSE	7.810249675906650	0.9394976653450500	0.9704274492975350	0.9988404687734890
    BraTS20_Training_363	WT	FALSE	9.848857801796100	0.9559372909835400	0.9734372144791270	0.9991364282189730
    BraTS20_Training_361	TC	FALSE	29.949958263743900	0.005206719147089820	0.012962962962963000	0.9985600733241010
    BraTS20_Training_275	TC	FALSE	53.907327887774200	0.018057203110583900	0.012977171544946500	0.9994976138339210
    BraTS20_Training_325	TC	FALSE	87.18371407550840	0.02637647737100030	0.018751921303412200	0.9995588816225080
    BraTS20_Training_250	TC	FALSE	35.45419580247170	0.18477261865372600	0.7696784073506890	0.9975995925929450
    BraTS20_Training_086	TC	FALSE	28.24889378365110	0.25634824667472800	0.1889483065953650	0.9999820777268820
    BraTS20_Training_298	TC	FALSE	15.556349186104000	0.295250179290561	0.184462673192252	0.9998940931462000
    BraTS20_Training_278	TC	FALSE	34.713109915419600	0.3327487148472940	0.2314721324717290	0.998929253129251
    BraTS20_Training_113	TC	FALSE	23.958297101421900	0.3997270600467900	0.9323935122025160	0.9979792416058330
    BraTS20_Training_158	TC	FALSE	18.547236990991400	0.4830148619957540	0.8895405669599220	0.9995888394674680
    BraTS20_Training_268	TC	FALSE	5.196152422706630	0.5404395275825980	0.3875013399078140	0.9999513380412840
    BraTS20_Training_306	TC	FALSE	11.180339887498900	0.5886644707391550	0.45367290402974200	0.9990357717907930
    BraTS20_Training_297	TC	FALSE	8.12403840463596	0.6142241379310350	0.45341437545892100	0.9999367663407340
    BraTS20_Training_129	TC	FALSE	16.0312195418814	0.6342455406426120	0.6392597798079180	0.9996395522510210
    BraTS20_Training_303	TC	FALSE	6.4031242374328500	0.6442614759618520	0.5884594015398050	0.9993254932548200
    BraTS20_Training_309	TC	FALSE	7.0	0.6592478701416550	0.4955569449970630	0.9999061484337330
    BraTS20_Training_133	TC	FALSE	7.874007874011810	0.6611902516503700	0.5295146480104940	0.9993845826429940
    BraTS20_Training_345	TC	FALSE	21.72556098240040	0.6632984981659630	0.7789336801040310	0.9996071441701320
    BraTS20_Training_171	TC	FALSE	40.80441152620630	0.6675241254296700	0.6323965340326070	0.9979217262192370
    BraTS20_Training_100	TC	FALSE	11.045361017187300	0.6702971290905440	0.5189834065208100	0.9997423961966830
    BraTS20_Training_266	TC	FALSE	10.344080432788600	0.6826592965258140	0.5501113585746100	0.9998012195165800
    BraTS20_Training_134	TC	FALSE	3.605551275463990	0.7160093890269180	0.5761719612954540	0.9998306827605110
    BraTS20_Training_295	TC	FALSE	13.601470508735400	0.7196000183477820	0.7284546805349180	0.9996423778141020
    BraTS20_Training_261	TC	FALSE	15.684387141358100	0.7456825806451610	0.7177291153326450	0.9976364372917270
    BraTS20_Training_050	TC	FALSE	7.810249675906650	0.7576823874564580	0.6282539355900810	0.9997688478975150
    BraTS20_Training_239	TC	FALSE	25.25866188063020	0.7607793037368250	0.7972332236291630	0.9993992192881020
    BraTS20_Training_216	TC	FALSE	7.874007874011810	0.7655772961754220	0.6510628501266210	0.9997810754460590
    BraTS20_Training_005	TC	FALSE	1.7320508075688800	0.7768222426317110	0.6456627342123530	0.9999730748217050
    BraTS20_Training_294	TC	FALSE	12.36931687685300	0.7770986253836920	0.8059461853615330	0.9989100162890260
    BraTS20_Training_076	TC	FALSE	3.0	0.7825958177833070	0.6943291112629420	0.9998289365115370
    BraTS20_Training_080	TC	FALSE	27.712812921102000	0.7964053833254500	0.8769886363636360	0.9996146876233540
    BraTS20_Training_097	TC	FALSE	13.45362404707370	0.8198289204192660	0.7138292206639450	0.9998072419503780
    BraTS20_Training_160	TC	FALSE	11.74734012447070	0.8225834457519130	0.7509205745360550	0.9993061259649290
    BraTS20_Training_340	TC	FALSE	71.05631569396210	0.8333599446484650	0.8271526677231910	0.9991582847024580
    BraTS20_Training_207	TC	FALSE	9.0	0.8343289171020490	0.8509438766231400	0.9994165500909110
    BraTS20_Training_036	TC	FALSE	7.874007874011810	0.8430081441691220	0.8459398365501650	0.9998962145082480
    BraTS20_Training_244	TC	FALSE	9.486832980505140	0.8478838805638430	0.7928190043802160	0.9994546241666800
    BraTS20_Training_184	TC	FALSE	23.706539182259400	0.8505997818974920	0.9451097569583320	0.9986744691940140
    BraTS20_Training_048	TC	FALSE	7.0710678118654800	0.8529817568603400	0.8038139266108060	0.999968625830421
    BraTS20_Training_355	TC	FALSE	7.810249675906650	0.8537529292020740	0.7795139451702490	0.999512192858345
    BraTS20_Training_265	TC	FALSE	8.366600265340760	0.8653194779963450	0.7798461042252220	0.9998895841498220
    BraTS20_Training_348	TC	FALSE	15.556349186104000	0.8658924081527400	0.7828925454666580	0.9998280325251950
    BraTS20_Training_079	TC	FALSE	3.0	0.8662790697674420	0.8669991687448050	0.9999455425025640
    BraTS20_Training_198	TC	FALSE	18.138357147217100	0.8748925151927960	0.8181308951609990	0.9996749564786560
    BraTS20_Training_122	TC	FALSE	19.1049731745428	0.8807995449744050	0.9552344025378920	0.9998640489038400
    BraTS20_Training_363	TC	FALSE	11.180339887498900	0.8863195444020280	0.8043675810757090	0.999914875092181
    BraTS20_Training_061	TC	FALSE	13.784048752090200	0.8899058866949620	0.8990305741983590	0.9998172658529440
    BraTS20_Training_010	TC	FALSE	9.1104335791443	0.9007358462231570	0.8575922219044900	0.9999634570361240
    BraTS20_Training_339	TC	FALSE	11.224972160321800	0.9039661075241920	0.9033870766154230	0.9993115968516220
    BraTS20_Training_098	TC	FALSE	59.61543424315550	0.9098808437343340	0.9503262358027010	0.9994195094973350
    BraTS20_Training_151	TC	FALSE	26.94438717061500	0.9112236562653160	0.8799141793399380	0.9996326968399750
    BraTS20_Training_001	TC	FALSE	22.516660498395400	0.9155218526116800	0.9868704411253910	0.999178598541444
    BraTS20_Training_179	TC	FALSE	18.384776310850200	0.9166840949492840	0.9558663177407040	0.9994652085248120
    BraTS20_Training_107	TC	FALSE	11.832159566199200	0.9171998494542720	0.9617205998421470	0.9998461514999560
    BraTS20_Training_315	TC	FALSE	73.00684899377590	0.9191028054339690	0.898700492304963	0.99985593096724
    BraTS20_Training_090	TC	FALSE	13.076696830622000	0.9201898960945900	0.9769388046217490	0.9996543156263370
    BraTS20_Training_271	TC	FALSE	10.0	0.9217005023456640	0.9482338871567080	0.9997125077221440
    BraTS20_Training_185	TC	FALSE	6.324555320336760	0.9229098156452420	0.9253626953359180	0.9995493333038970
    BraTS20_Training_338	TC	FALSE	10.198039027185600	0.9235316960287840	0.9123177853977800	0.9995432153375860
    BraTS20_Training_197	TC	FALSE	6.164414002968980	0.9240297335573870	0.8731866973622170	0.9998634807507860
    BraTS20_Training_359	TC	FALSE	2.8284271247461900	0.9258108791446940	0.8717520163249440	0.9999335326976880
    BraTS20_Training_144	TC	FALSE	5.744562646538030	0.9284901042412340	0.9367992406003660	0.9993342978016240
    BraTS20_Training_052	TC	FALSE	11.874342087037900	0.9310131613815030	0.9362785739666000	0.9998578180012060
    BraTS20_Training_124	TC	FALSE	16.06237840420900	0.9312701879595160	0.9392856256360610	0.999290302060735
    BraTS20_Training_175	TC	FALSE	7.810249675906650	0.9322286293644260	0.9289322472690530	0.999311557212075
    BraTS20_Training_130	TC	FALSE	4.358898943540670	0.9330432638105980	0.9027337491904420	0.9997863422767410
    BraTS20_Training_337	TC	FALSE	8.12403840463596	0.9389468460178460	0.90994168453538	0.9998410695803240
    BraTS20_Training_209	TC	FALSE	3.1622776601683800	0.9443203224251980	0.9755832635604530	0.9995491798619260
    BraTS20_Training_351	TC	FALSE	35.185224171518400	0.9451136535456880	0.9659008962604310	0.9998298270904050
    BraTS20_Training_169	TC	FALSE	9.899494936611670	0.9460899440366110	0.975156310518453	0.9996492295082670
    BraTS20_Training_336	TC	FALSE	13.152946437965900	0.9476840598805120	0.9207374492378320	0.9998282174022770
    BraTS20_Training_093	TC	FALSE	14.071247279470300	0.955135000311779	0.9694927054653630	0.9997848568201910
    BraTS20_Training_040	TC	FALSE	17.916472867168900	0.9557249700425600	0.9558632090091950	0.9997578721125550
    BraTS20_Training_186	TC	FALSE	22.64950330581230	0.957883972535641	0.9471644885542890	0.9997979514851300
    BraTS20_Training_270	TC	FALSE	1.7320508075688800	0.9617129619350020	0.9519267399267400	0.9997864499562630
    BraTS20_Training_298	ET	FALSE	2.8284271247461900	0.07920792079207920	0.0425531914893617	0.9999996639749570
    BraTS20_Training_315	ET	FALSE	97.02061636580140	0.3669724770642200	0.3669724770642200	0.9999922714110200
    BraTS20_Training_048	ET	FALSE	1.0	0.4204502098435710	0.2699657030867220	0.999996751049383
    BraTS20_Training_303	ET	FALSE	20.12461179749810	0.42629904559915200	0.30362537764350500	0.9999820761949910
    BraTS20_Training_158	ET	FALSE	15.297058540778400	0.4508870618779750	0.3134777376654630	0.9999856604130380
    BraTS20_Training_086	ET	FALSE	14.071247279470300	0.48484848484848500	0.5283018867924530	0.9999922714136170
    BraTS20_Training_271	ET	FALSE	3.605551275463990	0.4934210526315790	0.33482142857142900	0.9999994399501060
    BraTS20_Training_250	ET	FALSE	26.30589287593180	0.5534000408413310	0.42106898694841500	0.9999636965922530
    BraTS20_Training_261	ET	FALSE	19.8997487421324	0.5665442573129040	0.4686779803058870	0.999801086600884
    BraTS20_Training_309	ET	FALSE	16.76305461424020	0.6001333629695490	0.6831983805668020	0.9998685865061530
    BraTS20_Training_134	ET	FALSE	3.4641016151377500	0.630993795502636	0.47929606625258800	0.9999178418536490
    BraTS20_Training_079	ET	FALSE	5.477225575051660	0.6409469530907500	0.9945578231292520	0.9998173982499360
    BraTS20_Training_160	ET	FALSE	8.246211251235320	0.6410967344423910	0.4983834271344750	0.9997881859951820
    BraTS20_Training_076	ET	FALSE	5.477225575051660	0.6457097874573600	0.5806512505899010	0.9997411803097430
    BraTS20_Training_129	ET	FALSE	14.7648230602334	0.6480147428379960	0.5422683302958080	0.9998949653660350
    BraTS20_Training_171	ET	FALSE	31.89043743820400	0.6644971224993150	0.572415014164306	0.9997139508493720
    BraTS20_Training_113	ET	FALSE	30.14962686336270	0.6702089119671540	0.652787579393084	0.9998593640408310
    BraTS20_Training_005	ET	FALSE	2.23606797749979	0.7007117252844300	0.6252549601335060	0.9998072267863030
    BraTS20_Training_197	ET	FALSE	6.164414002968980	0.7100500668741940	0.5548054158034920	0.9999517688655860
    BraTS20_Training_061	ET	FALSE	9.9498743710662	0.7169602654238090	0.69473361910594	0.9998218902987710
    BraTS20_Training_133	ET	FALSE	21.0	0.7271386948432620	0.5813313875168390	0.9999647594258440
    BraTS20_Training_216	ET	FALSE	3.0	0.7356235486955330	0.6299935661227120	0.9998410935457380
    BraTS20_Training_244	ET	FALSE	9.433981132056600	0.7408010484719710	0.6924676096076030	0.999464221295816
    BraTS20_Training_080	ET	FALSE	17.72004514666940	0.7788622420524260	0.8352272727272730	0.9997679713477120
    BraTS20_Training_239	ET	FALSE	19.209372712298500	0.7822950819672130	0.8130025896142840	0.999781630580597
    BraTS20_Training_036	ET	FALSE	7.0710678118654800	0.7853184147234130	0.7268679829655440	0.9999280497653550
    BraTS20_Training_050	ET	FALSE	7.874007874011810	0.7950157512242290	0.7873779809712100	0.9992961711078750
    BraTS20_Training_100	ET	FALSE	12.328828005938000	0.8107273707898600	0.7261702482092290	0.9997799501797320
    BraTS20_Training_348	ET	FALSE	13.379088160259700	0.811017658548252	0.6973858598784330	0.9998896922842450
    BraTS20_Training_345	ET	FALSE	1.0	0.818880567599527	0.6992595085829690	0.9999942838300310
    BraTS20_Training_052	ET	FALSE	8.774964387392120	0.836378548320955	0.8422501605946590	0.9997900663477810
    BraTS20_Training_130	ET	FALSE	4.69041575982343	0.8401680966555770	0.7619818961410200	0.9998163325751710
    BraTS20_Training_359	ET	FALSE	6.4031242374328500	0.8418022482555070	0.7326060759814800	0.9999717865498500
    BraTS20_Training_179	ET	FALSE	18.384776310850200	0.8432091372486020	0.8242953825066390	0.9994847621961630
    BraTS20_Training_207	ET	FALSE	5.744562646538030	0.8440194191010300	0.7920119388917250	0.9997575971883070
    BraTS20_Training_337	ET	FALSE	9.273618495495700	0.8550736171906090	0.7611221309152740	0.9999393242610370
    BraTS20_Training_336	ET	FALSE	11.704699910719600	0.868033290128931	0.7909065481555150	0.9998864635683510
    BraTS20_Training_097	ET	FALSE	12.767145334803700	0.8692425973732840	0.82835479794585	0.9996755075214210
    BraTS20_Training_090	ET	FALSE	10.723805294763600	0.8711198589412390	0.9688070047427950	0.9996858821698150
    BraTS20_Training_010	ET	FALSE	5.385164807134500	0.8796357615894040	0.8207940676656880	0.999967046000085
    BraTS20_Training_198	ET	FALSE	17.944358444926400	0.8797647137017710	0.8713669727790400	0.9996259673514900
    BraTS20_Training_363	ET	FALSE	8.774964387392120	0.880459688238297	0.7967383597258330	0.999931430185063
    BraTS20_Training_040	ET	FALSE	16.73320053068150	0.8816507378519900	0.8537035067191430	0.9997372973788050
    BraTS20_Training_001	ET	FALSE	19.131126469709000	0.8835006049039820	0.9345036406892080	0.9994359714066720
    BraTS20_Training_209	ET	FALSE	2.0	0.8869342223361970	0.888734710658855	0.9997481069292820
    BraTS20_Training_124	ET	FALSE	16.06237840420900	0.8905634240129930	0.8724350125178410	0.9995822294921890
    BraTS20_Training_185	ET	FALSE	7.483314773547880	0.8914332759067560	0.9353703407454810	0.9994266442389890
    BraTS20_Training_339	ET	FALSE	11.874342087037900	0.8927768730737660	0.8609921345689590	0.9997061694405640
    BraTS20_Training_122	ET	FALSE	10.862780491200200	0.892787014007069	0.9443367488230410	0.9999307515618160
    BraTS20_Training_340	ET	FALSE	68.7749954561976	0.8967593293308440	0.8620109925638540	0.9997897060492950
    BraTS20_Training_175	ET	FALSE	3.7416573867739400	0.8968250292753610	0.8578516371552610	0.9995068364291480
    BraTS20_Training_098	ET	FALSE	59.481089431852200	0.9004952924902950	0.9151550879738800	0.9997092954057220
    BraTS20_Training_338	ET	FALSE	9.1104335791443	0.9070416871453470	0.8615413996519970	0.9997976550506180
    BraTS20_Training_151	ET	FALSE	3.605551275463990	0.9154132423631570	0.9296118415872770	0.9995653492948230
    BraTS20_Training_186	ET	FALSE	21.77154105707720	0.9194400589411640	0.872094880600591	0.9998594264690050
    BraTS20_Training_270	ET	FALSE	2.0	0.9236608801826190	0.865837272953471	0.999939104944171
    BraTS20_Training_093	ET	FALSE	21.470910553583900	0.924310224163892	0.8954267165221680	0.999884991154764
    BraTS20_Training_355	ET	FALSE	6.164414002968980	0.9244120321969210	0.9017179053493850	0.9996655274753500
    BraTS20_Training_184	ET	FALSE	2.0	0.929593817462765	0.9511099561957090	0.9997119444848270
    BraTS20_Training_169	ET	FALSE	7.681145747868610	0.9307446474424100	0.9600243893144320	0.9996966891599740
    BraTS20_Training_351	ET	FALSE	35.4400902933387	0.9327407020066670	0.8850161250310100	0.9999771091967620
    BraTS20_Training_144	ET	FALSE	3.4641016151377500	0.934888160351911	0.9234149300716500	0.9996420438955230
    BraTS20_Training_107	ET	FALSE	11.0	0.9455419113721300	0.9280997798972850	0.9999625495839580

After filtering by WT and sorting by Hausdorff, I found the 20 worst performers as follows (the first is the worst, with the highest Hausdorff score):

    BraTS20_Training_079 
    114.31972708155000

    BraTS20_Training_361
    102.57192598367300

    BraTS20_Training_086
    101.7742600071350
    
    BraTS20_Training_268
    98.5393322486001

    BraTS20_Training_325
    94.94208761134340

    BraTS20_Training_315
    92.00543462209180

    BraTS20_Training_207
    90.77995373429090
    
    BraTS20_Training_005
    88.87631855561980

    BraTS20_Training_298
    87.80091115700340

    BraTS20_Training_134
    85.65628990331070

    BraTS20_Training_359
    85.53946457629950

    BraTS20_Training_266
    82.42572413997950

    BraTS20_Training_036
    80.77747210701760

    BraTS20_Training_336
    79.71198153351850

    BraTS20_Training_122
    78.45380806563820

    BraTS20_Training_337
    78.06407624509500

    BraTS20_Training_295
    78.03204469959760

    BraTS20_Training_275
    76.68115805072330

    BraTS20_Training_010
    76.42643521714200

    BraTS20_Training_184
    75.67033764957050

Similarly, I found the 20 best performers as follows (the last in the table is the absolute best, with the lowest Hausdorff score):

    BraTS20_Training_171
    37.3496987939662

    BraTS20_Training_278
    37.107950630558900

    BraTS20_Training_160
    35.22782990761710

    BraTS20_Training_093
    34.84250278036870

    BraTS20_Training_185
    34.322004603461000

    BraTS20_Training_100
    31.559467676119

    BraTS20_Training_169
    29.30870177950570

    BraTS20_Training_040
    29.223278392404900

    BraTS20_Training_244
    28.861739379323600

    BraTS20_Training_133
    28.722813232690100

    BraTS20_Training_216
    27.80287754891570

    BraTS20_Training_001
    21.283796653792800

    BraTS20_Training_261
    15.684387141358100

    BraTS20_Training_355
    14.7648230602334

    BraTS20_Training_098
    13.92838827718410

    BraTS20_Training_179
    13.74772708486750

    BraTS20_Training_130
    13.564659966250500

    BraTS20_Training_124
    12.328828005938000

    BraTS20_Training_363
    9.848857801796100

    BraTS20_Training_306
    9.273618495495700

    BraTS20_Training_198
    7.810249675906650

### Data Analysis - Radiomics
- Now that I identified the 20 best and 20 worst cases, my next step was to extract Radiomics information for best & most poorly performing cases.
- Radiomics extracts 100+ quantitative metrics from medical images that capture information about tumors or other lesions (i.e. shape, texture, intensity, spatial arrangement, etc)
- I used 3D Slicer’s SlicerRadiomics extension which encapsulates the pyRadiomics library. The newest version of 3D Slicer currently has a bug so SlicerRadiomics does not work on Mac, so I downloaded 3D Slicer Version 5.2.2, which had a SlicerRadiomics that worked on my computer. 
https://www.slicer.org

- I needed to input a raw scan & a segmentation file for it to extract information about the scans and tumor. 

![Screenshot%202025-06-08%20at%2011.09.46%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2011.09.46%E2%80%AFAM.png)

- I chose to Use .flair MRI scans for raw scan because they work best for WT (whole tumor) according to my research
- My goal with Radiomics was to extract quantitative information about the tumors/scans into tables that could be analyzed by LLMs or statistical methods
- I entered the .flair and .seg files for each of the 20 best and 20 worst cases, and ran the feature extraction on each. The output of this was a .tsv file with quantitative values for each feature it can analyze. 

![Screenshot%202025-06-08%20at%2011.11.21%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2011.11.21%E2%80%AFAM.png)

### Data Analysis - LLM 
- Now that I had the best & worst case radiomics data files, I was able to provide them to LLMs to run data analysis. I chose to use the ChatGPT with GPT-4o.
- For each of these 40 cases, I provided ChatGPT with the patient ID number, its Hausdorff score, if it was a good or bad case, and its .tsv Radiomics file. I directed it to compare the different features of each tumor/scan to see what features were associated with a difference in high versus low performance. 
- In response, it outputed the 20 most differentiating radiomics features in a table. It was comparing the average of each metric for the 'best cases' to the average of each metric for the 'worst cases'. And using Cohen's D as a statistical analysis metric. A large positive Cohen’s D indicates that the feature is higher in worst-segmented tumors, while a large negative Cohen’s D means the feature is higher in best-segmented tumors.

![Screenshot%202025-06-08%20at%2011.18.29%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2011.18.29%E2%80%AFAM.png)

### Results 
- I converted the table provided by ChatGPT into a graphical representation to compare the Cohen's d values for each feature. Additionally, I categorized each feature into broader groups based on what they describe, such as shape, texture homogeneity, size, or gray-level distribution.

![Screenshot%202025-06-08%20at%2011.21.32%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2011.21.32%E2%80%AFAM.png)

- Through analysis with ChatGPT, I was able to make these conclusions:

![Screenshot%202025-06-08%20at%2011.25.41%E2%80%AFAM.png](Screenshot%202025-06-08%20at%2011.25.41%E2%80%AFAM.png)

### Future
- Overall, I really enjoyed learning and combining these tools and seeing the capabilities in computational biology. 
- If I were to expand upon this project in the future, I would
    1. Train model on more Epochs.
    2. Update code so that it can calculate metrics (Dice, Hausdorff distance) for validation data, not just training data.
    3. Perform a complete data analysis using additional segmentation evaluation metrics beyond the Hausdorff distance, including Dice score, sensitivity, and specificity.
    4. Learn more about performing quantitative data analysis on my own to compare Radionomics files & find trends, rather than relying on LLMs.

